/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `facturacion` AS ( SELECT `bdfactura`.`idFactura`        AS `idFactura`, CAST(SUBSTR(`bdfactura`.`idFactura`,6,100) AS SIGNED) AS `ordenId`, `bdterceros`.`nombre`          AS `nombre`, `bdterceros`.`id`              AS `cliente`, `bdfactura`.`vendedor`         AS `vendedor`, `bdfactura`.`red`              AS `red`, `bdfactura`.`fechaVencimiento` AS `fechaVencimiento`, `bdfactura`.`efectivoGeneral`  AS `efectivoGeneral`, `bdfactura`.`ncGeneral`        AS `ncGeneral`, `bdfactura`.`chequeGeneral`    AS `chequeGeneral`, `bdfactura`.`targetaGeneral`   AS `targetaGeneral`, `bdfactura`.`totalGeneral`     AS `totalGeneral`, `bdfactura`.`descuentoGeneral` AS `descuentoGeneral`, `bdfactura`.`ivaGeneral`       AS `ivaGeneral`, `bdfactura`.`subtotalGeneral`  AS `subtotalGeneral`, `bdfactura`.`comprobante`      AS `comprobante`, `bdfactura`.`cotizacion`       AS `cotizacion`, `bdfactura`.`anulada`          AS `anulada`, `bdfactura`.`anula`            AS `anula`, `bdfactura`.`credito`          AS `credito`, `bdfactura`.`cxc`              AS `cxc`, `bdfactura`.`usuario`          AS `usuario`, `bdfactura`.`rtIva`            AS `rtIva`, `bdfactura`.`rtIca`            AS `rtIca`, `bdfactura`.`rtFuente`         AS `rtFuente`, `bdfactura`.`otros`            AS `otros`, `bdfactura`.`observacion`      AS `observacion`, `bdfactura`.`anulada1`         AS `anulada1`, `bdfactura`.`anula1`           AS `anula1`, `bdfactura`.`credito1`         AS `credito1`, `bdfactura`.`cxc1`             AS `cxc1`, `bdfactura`.`usuario1`         AS `usuario1`, `bdfactura`.`fechaAlerta`      AS `fechaAlerta`, `bdfactura`.`terminal`         AS `terminal`, `bdfactura`.`estadoGeneral`    AS `estadoGeneral`, `bdfactura`.`estado2`          AS `estado2`, `bdfactura`.`devuelta`         AS `devuelta`, `bdfactura`.`factura`          AS `factura`, `bdfactura`.`resolucion`       AS `resolucion`, `bdfactura`.`fechaAnulacion`   AS `fechaAnulacion`, `bdfactura`.`cuadreAnulacion`  AS `cuadreAnulacion`, `bdfactura`.`usuarioAnula`     AS `usuarioAnula`, `bdfactura`.`placa`            AS `placa`, `bdfactura`.`garantia`         AS `garantia`, `bdfactura`.`diasGarantia`     AS `diasGarantia`, ''                             AS `rango`, `bdfactura`.`terminos`         AS `terminos`, `bdfactura`.`notaAnulacion`    AS `notaAnulacion`, `bdfactura`.`conseMesa`                            AS `conseMesa`, `bdfactura`.`factura`          AS `id2`, `bdfactura`.`copago`           AS `copago`, `bdprestamo`.`cuotaInicial`    AS `cuotaInicial2`, CAST(`bdfactura`.`fechaFactura` AS DATE) AS `fechaFactura`, `bdfactura`.`turno`            AS `turno`, `bdfactura`.`impuesto`         AS `impuesto`, `bdterceros`.`idSistema`       AS `idSistema`, CAST(`bdfactura`.`fechaFactura` AS DATE) AS `fechaFactura1`, `bdfactura`.`impoGeneral`      AS `impoconsumo`, `bdfactura`.`tarjetaCredito`   AS `tarjetaCredito`, `bdfactura`.`franquisia`       AS `franquisia`, `bdfactura`.`hora`             AS `hora`, `bdfactura`.`valorComision`    AS `valorComision`, `bdfactura`.`totalPropina`     AS `totalPropina`, `bdfactura`.`sisteCredito`     AS `sisteCredito`, `bdfactura`.`bodega`           AS `bodega` FROM ((`bdfactura` LEFT JOIN `bdprestamo` ON (`bdfactura`.`idFactura` = `bdprestamo`.`factura`)) LEFT JOIN `bdterceros` ON (`bdfactura`.`cliente` = `bdterceros`.`idSistema`)) GROUP BY `bdfactura`.`idFactura`,CAST(SUBSTR(`bdfactura`.`idFactura`,6,100)AS SIGNED),`bdterceros`.`nombre`,`bdterceros`.`id`,`bdfactura`.`vendedor`,`bdfactura`.`red`,`bdfactura`.`fechaVencimiento`,`bdfactura`.`efectivoGeneral`,`bdfactura`.`ncGeneral`,`bdfactura`.`chequeGeneral`,`bdfactura`.`targetaGeneral`,`bdfactura`.`totalGeneral`,`bdfactura`.`descuentoGeneral`,`bdfactura`.`ivaGeneral`,`bdfactura`.`subtotalGeneral`,`bdfactura`.`comprobante`,`bdfactura`.`cotizacion`,`bdfactura`.`anulada`,`bdfactura`.`anula`,`bdfactura`.`credito`,`bdfactura`.`cxc`,`bdfactura`.`usuario`,`bdfactura`.`rtIva`,`bdfactura`.`rtIca`,`bdfactura`.`rtFuente`,`bdfactura`.`otros`,`bdfactura`.`anulada1`,`bdfactura`.`anula1`,`bdfactura`.`credito1`,`bdfactura`.`cxc1`,`bdfactura`.`usuario1`,`bdfactura`.`fechaAlerta`,`bdfactura`.`terminal`,`bdfactura`.`estadoGeneral`,`bdfactura`.`estado2`,`bdfactura`.`devuelta`,`bdfactura`.`resolucion`,`bdfactura`.`fechaAnulacion`,`bdfactura`.`cuadreAnulacion`,`bdfactura`.`usuarioAnula`,`bdfactura`.`placa`,`bdfactura`.`garantia`,`bdfactura`.`diasGarantia`,`bdfactura`.`factura`,`bdfactura`.`copago`,`bdprestamo`.`cuotaInicial`,`bdfactura`.`turno`,`bdfactura`.`impuesto`,`bdterceros`.`idSistema`,CAST(FORMAT(`bdfactura`.`fechaFactura`,'yyyy/mm/dd')AS DATE),`bdfactura`.`impoGeneral`,CAST(FORMAT(`bdfactura`.`fechaFactura`,'yyyy/mm/dd')AS DATE),`bdfactura`.`tarjetaCredito`,`bdfactura`.`franquisia`,`bdfactura`.`hora`,`bdfactura`.`valorComision`,`bdfactura`.`totalPropina`,`bdfactura`.`sisteCredito`,`bdfactura`.`bodega`) */;

ALTER TABLE bdmaestra ADD COLUMN `tieneSucursal` TINYINT(1) DEFAULT 0;
ALTER TABLE bdmaestra ADD COLUMN `numeroSucursal` CHAR (2) ;
ALTER TABLE configuracion ADD COLUMN `corresponsalWeb` VARCHAR(10) DEFAULT 0;

ALTER TABLE bdcongelada ADD COLUMN `cantidadSolicitada` VARCHAR (50) DEFAULT "0";
ALTER TABLE bdcomanda ADD COLUMN `cantidadSolicitada` VARCHAR (50) DEFAULT "0";
ALTER TABLE bdcomanda ADD COLUMN `idCongelada` VARCHAR (50) ;
ALTER TABLE bdcomanda ADD COLUMN `idComanda` VARCHAR (50) ;
ALTER TABLE bdPreCompraDetalle ADD COLUMN `plu` TINYINT (1) ;
UPDATE bdproductos SET Descripcion='GUARDERIA X DIA' WHERE Codigo='GD2';
UPDATE bdproductos SET Descripcion='GUARDERIA X HORA' WHERE Codigo='GD1';
DELETE FROM bdServiciosPTM;
DELETE FROM bdServiciosPTM1;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `impresioncomanda` AS SELECT `con`.`idFactura`     AS `idFactura`, `con`.`producto`      AS `producto`, `con`.`cantidad`      AS `cantidad`, `con`.`descripcion`   AS `descripcion`, `con`.`plu`           AS `plu`, `con`.`cant2`         AS `cant2`, `con`.`lista`         AS `lista`, `con`.`descuento`     AS `descuento`, `con`.`preparacion`   AS `preparacion`, `con`.`conseMesa`     AS `conseMesa`, `con`.`notaAnulacion` AS `notaAnulacion`, `con`.`rango`         AS `rango`, `con`.`porcDescuento` AS `porcDescuento`, `con`.`imei`          AS `imei`, `con`.`idProd`        AS `idProd`, `con`.`impoconsumo`   AS `impoconsumo`, `con`.`porcImpo`      AS `porcImpo`, `p`.`grupo`           AS `grupo`, `con`.`id`            AS `idComanda`, `con`.`cantidadSolicitada` AS `cantidadSolicitada` FROM (`bdcongelada` `con` JOIN `bdproductos` `p` ON (`p`.`idSistema` = `con`.`producto`))*/;
/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `ajustessalida` AS ( SELECT `bdtraslados`.`Id` AS `Id`, `bdtraslados`.`tipo`         AS `tipo`, `bdtraslados`.`anulada`      AS `anulada`, `bdtrasladosprod`.`producto` AS `producto`, `bdtrasladosprod`.`cantidad` AS `cantidad`, `bdtrasladosprod`.`cantidad2` AS `cantidad2`, `bdtrasladosprod`.`lista`    AS `lista`, `bdtrasladosprod`.`total`    AS `total`, `bdtraslados`.`usuario`      AS `usuario`, `bdtraslados`.`fecha`        AS `fecha`, `bdtraslados`.`bodega`       AS `bodega` FROM (`bdtraslados` LEFT JOIN (`bdtrasladosprod` LEFT JOIN `bdproductos` ON (`bdtrasladosprod`.`producto` = `bdproductos`.`idSistema`)) ON (`bdtraslados`.`Id` = `bdtrasladosprod`.`traslado`)) WHERE `bdtraslados`.`tipo` = 'Ajuste Salida' AND `bdtraslados`.`anulada` = 0) */;
/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `totalizadoajustesalida` AS  SELECT `bdproductos`.`idSistema` AS `codigo`, SUM(IF(`ajustessalida`.`cantidad2` IS NULL,'0',`ajustessalida`.`cantidad2`)) AS `Expr1` FROM (`bdproductos` LEFT JOIN `ajustessalida` ON (`bdproductos`.`idSistema` = `ajustessalida`.`producto`)) WHERE `ajustessalida`.`bodega` = '123-22' OR `ajustessalida`.`bodega` = '' GROUP BY `bdproductos`.`idSistema` */;
/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `inventario` AS ( SELECT `bdproductos`.`idSistema` AS `Codigo`,`bdproductos`.`Descripcion` AS `Descripcion`,`bdproductos`.`inventario` AS `inventario`,CAST(`bdproductos`.`inventario` AS SIGNED) AS `inv`,`bdproductos`.`fisicoInventario` AS `fisicoInventario`,`bdproductos`.`compras` AS `compras`,`bdproductos`.`ventas` AS `ventas`,`bdproductos`.`nc` AS `nc`,`bdproductos`.`ajusteEntrada` AS `ajusteEntrada`,`bdproductos`.`ajusteSalida` AS `ajusteSalida`,`bdproductos`.`planSepare` AS `planSepare`,`bdproductos`.`pedidos` AS `pedidos`,`bdproductos`.`anulacion` AS `anulacion`,`bdproductos`.`inventarioInicial` AS `inventarioInicial`,`bdproductos`.`ajusteInventario` AS `ajusteInventario`,`bdproductos`.`armado` AS `armado`,`bdproductos`.`costeo` AS `costeo`,`ultimoponderado`.`nuevoPonderado` AS `costoUnd`,`ultimoponderado`.`ultimoCosto` AS `ultimoCosto`,`bdproductos`.`minimo` AS `minimo`,IF(CAST(`bdproductos`.`fisicoInventario` AS SIGNED) <= 0,'SIN INVENTARIO',IF(CAST(`bdproductos`.`fisicoInventario` AS SIGNED) < `bdproductos`.`minimo`,'BAJO',IF(CAST(`bdproductos`.`fisicoInventario` AS SIGNED) = `bdproductos`.`minimo`,'MEDIO','ALTO'))) AS `estado`,`bdproductos`.`L1` AS `L1`,`bdproductos`.`L2` AS `L2`,`bdproductos`.`referencia` AS `referencia`,`bdproductos`.`ubicacion1` AS `ubicacion1`,`bdgrupo`.`nombre` AS `grupoDesc`,`bdsubgrupo`.`nombre` AS `subGrupoDesc`,`bdterceros`.`nombre` AS `proveedorNombre`,`bdproductos`.`grupo` AS `Grupo`,CAST(REPLACE(`ultimoponderado`.`nuevoPonderado`,',','.') AS DOUBLE) * CAST(REPLACE(`bdproductos`.`inventario`,',','.') AS DOUBLE) AS `costoPTotal`,CAST(REPLACE(`ultimoponderado`.`ultimoCosto`,',','.') AS DOUBLE) * CAST(REPLACE(`bdproductos`.`inventario`,',','.') AS DOUBLE) AS `costoTotal`,`bdproductos`.`ordenServicio` AS `ordenServicio`,`bdproductos`.`manejaInventario` AS `manejaInventario`,`bdproductos`.`Proveedor` AS `Proveedor`,`ultimoponderado`.`fecha` AS `fecha`,`bdproductos`.`Codigo` AS `Codigo1`,`bdproductos`.`codigoBarras` AS `codigoBarras`,`bdproductos`.`trasladoInternoEntrada` AS `trasladoInternoEntrada`,`bdproductos`.`trasladoInternoSalida` AS `trasladoInternoSalida`,`bdproductos`.`congelada` AS `congelada`,`bdproductos`.`trasladoBod` AS `trasladoBod`,`bdproductos`.`enTransito` AS `enTransito`,`bdproductos`.`notaDebito` AS `nd` FROM ((((`bdproductos` LEFT JOIN `bdgrupo` ON(`bdgrupo`.`codigo` = `bdproductos`.`grupo`)) LEFT JOIN `bdsubgrupo` ON(`bdsubgrupo`.`codigo` = `bdproductos`.`Sub_grupo`)) LEFT JOIN `bdterceros` ON(`bdterceros`.`id` = `bdproductos`.`Proveedor`)) LEFT JOIN `ultimoponderado` ON(`ultimoponderado`.`producto` = `bdproductos`.`idSistema`))) */;
/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `ajustesentrada` AS ( SELECT `bdtraslados`.`Id`           AS `Id`, `bdtraslados`.`tipo`         AS `tipo`, `bdtraslados`.`anulada`      AS `anulada`, `bdtrasladosprod`.`producto` AS `producto`, `bdtrasladosprod`.`cantidad` AS `cantidad`, `bdtrasladosprod`.`lista`    AS `lista`, `bdtrasladosprod`.`total`    AS `total`, `bdtraslados`.`fecha`        AS `fecha`, `bdtraslados`.`usuario`      AS `usuario`, `bdtraslados`.`bodega`       AS `bodega`, `bdtrasladosprod`.`cantidad2` AS `cantidad2` FROM (`bdtraslados` LEFT JOIN (`bdtrasladosprod` LEFT JOIN `bdproductos` ON (`bdtrasladosprod`.`producto` = `bdproductos`.`Codigo`)) ON (`bdtraslados`.`Id` = `bdtrasladosprod`.`traslado`)) WHERE `bdtraslados`.`tipo` = 'Ajustes Entrada' AND `bdtraslados`.`anulada` = 0) */;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `repcartera2` AS select `reppendientes`.`factura` AS `fact`,`reppendientes`.`tipo` AS `tipo`,`reppendientes`.`estado` AS `estado`,`reppendientes`.`recibo` AS `recibo`,`reppendientes`.`plazo` AS `plazo`,`reppendientes`.`vencimiento` AS `vencimiento`,`reppendientes`.`cliente` AS `cliente`,`reppendientes`.`nombre` AS `nombre`,`reppendientes`.`fechaFactura` AS `fechaFactura`,`reppendientes`.`anulada` AS `anulada`,if(isnull(`repcartera`.`valor`),`reppendientes`.`valor`,(`reppendientes`.`valor` - `repcartera`.`valor`)) AS `Expr1`,`reppendientes`.`vendedor` AS `vendedor`,`reppendientes`.`factura` AS `factura`,`reppendientes`.`terminal` AS `terminal`,`reppendientes`.`factura2` AS `factura2`,`reppendientes`.`valor` AS `valor`,`reppendientes`.`telefono` AS `telefono`,cast((`reppendientes`.`vencimiento` - cast(now() as date)) as signed) AS `edadCartera`,if((cast(now() as date) >= `reppendientes`.`vencimiento`),'VENCIDA','OK') AS `estadoVenc`,`reppendientes`.`turno` AS `turno`,`reppendientes`.`placa` AS `placa`,`reppendientes`.`direccion` AS `direccion`,`reppendientes`.`ciudad` AS `ciudad`,`reppendientes`.`idSistema` AS `idSistema`,`reppendientes`.`conseMesa` AS `conseMesa` from (`reppendientes` left join `repcartera` on((`reppendientes`.`factura2` = `repcartera`.`fact`))) group by `reppendientes`.`factura`,`reppendientes`.`tipo`,`reppendientes`.`estado`,`reppendientes`.`recibo`,`reppendientes`.`plazo`,`reppendientes`.`vencimiento`,`reppendientes`.`cliente`,`reppendientes`.`nombre`,`reppendientes`.`fechaFactura`,`reppendientes`.`anulada`,if(isnull(`repcartera`.`valor`),`reppendientes`.`valor`,(`reppendientes`.`valor` - `repcartera`.`valor`)),`reppendientes`.`vendedor`,`reppendientes`.`terminal`,`reppendientes`.`valor`,`reppendientes`.`telefono`,`reppendientes`.`turno`,`reppendientes`.`placa`,`reppendientes`.`direccion`,`reppendientes`.`idSistema`,`reppendientes`.`conseMesa` having (`reppendientes`.`tipo` = 'FACT') */;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `repcarterapendientecuentacobro` AS select `reppendientescuentacobro`.`factura` AS `fact`,`reppendientescuentacobro`.`tipo` AS `tipo`,`reppendientescuentacobro`.`estado` AS `estado`,`reppendientescuentacobro`.`recibo` AS `recibo`,`reppendientescuentacobro`.`plazo` AS `plazo`,`reppendientescuentacobro`.`vencimiento` AS `vencimiento`,`reppendientescuentacobro`.`cliente` AS `cliente`,`reppendientescuentacobro`.`nombre` AS `nombre`,`reppendientescuentacobro`.`fechaFactura` AS `fechaFactura`,`reppendientescuentacobro`.`anulada` AS `anulada`,if(isnull(`repcarteracuentacobro`.`valor`),`reppendientescuentacobro`.`valor`,(`reppendientescuentacobro`.`valor` - `repcarteracuentacobro`.`valor`)) AS `Expr1`,`reppendientescuentacobro`.`vendedor` AS `vendedor`,`reppendientescuentacobro`.`factura` AS `factura`,`reppendientescuentacobro`.`terminal` AS `terminal`,`reppendientescuentacobro`.`valor` AS `valor`,`reppendientescuentacobro`.`telefono` AS `telefono`,cast((`reppendientescuentacobro`.`vencimiento` - curdate()) as signed) AS `edadCartera`,if((now() >= `reppendientescuentacobro`.`vencimiento`),'VENCIDA','OK') AS `estadoVenc`,`reppendientescuentacobro`.`placa` AS `placa`,`reppendientescuentacobro`.`direccion` AS `direccion`,`reppendientescuentacobro`.`ciudad` AS `ciudad`,`reppendientescuentacobro`.`idSistema` AS `idSistema` from (`reppendientescuentacobro` left join `repcarteracuentacobro` on((`reppendientescuentacobro`.`fact` = `repcarteracuentacobro`.`fact`))) group by `reppendientescuentacobro`.`factura`,`reppendientescuentacobro`.`tipo`,`reppendientescuentacobro`.`estado`,`reppendientescuentacobro`.`recibo`,`reppendientescuentacobro`.`plazo`,`reppendientescuentacobro`.`vencimiento`,`reppendientescuentacobro`.`cliente`,`reppendientescuentacobro`.`nombre`,`reppendientescuentacobro`.`fechaFactura`,`reppendientescuentacobro`.`anulada`,if(isnull(`repcarteracuentacobro`.`valor`),`reppendientescuentacobro`.`valor`,(`reppendientescuentacobro`.`valor` - `repcarteracuentacobro`.`valor`)),`reppendientescuentacobro`.`vendedor`,`reppendientescuentacobro`.`terminal`,`reppendientescuentacobro`.`valor`,`reppendientescuentacobro`.`telefono`,`reppendientescuentacobro`.`placa`,`reppendientescuentacobro`.`direccion`,`reppendientescuentacobro`.`ciudad`,`reppendientescuentacobro`.`idSistema` having (`reppendientescuentacobro`.`tipo` = 'CUENTACOBRO') */;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `repcarterapendientesepares` AS select `reppendientessepares`.`factura` AS `fact`,`reppendientessepares`.`tipo` AS `tipo`,`reppendientessepares`.`estado` AS `estado`,`reppendientessepares`.`recibo` AS `recibo`,`reppendientessepares`.`plazo` AS `plazo`,`reppendientessepares`.`vencimiento` AS `vencimiento`,`reppendientessepares`.`cliente` AS `cliente`,`reppendientessepares`.`nombre` AS `nombre`,`reppendientessepares`.`fechaFactura` AS `fechaFactura`,`reppendientessepares`.`anulada` AS `anulada`,if(isnull(`repcarterasepares`.`valor`),`reppendientessepares`.`valor`,(`reppendientessepares`.`valor` - `repcarterasepares`.`valor`)) AS `Expr1`,`reppendientessepares`.`vendedor` AS `vendedor`,`reppendientessepares`.`factura` AS `factura`,`reppendientessepares`.`terminal` AS `terminal`,`reppendientessepares`.`valor` AS `valor`,`reppendientessepares`.`telefono` AS `telefono`,cast((`reppendientessepares`.`vencimiento` - curdate()) as signed) AS `edadCartera`,if((now() >= `reppendientessepares`.`vencimiento`),'VENCIDA','OK') AS `estadoVenc`,`reppendientessepares`.`placa` AS `placa`,`reppendientessepares`.`direccion` AS `direccion`,`reppendientessepares`.`ciudad` AS `ciudad`,`reppendientessepares`.`idSistema` AS `idSistema` from (`reppendientessepares` left join `repcarterasepares` on((`reppendientessepares`.`fact` = `repcarterasepares`.`fact`))) group by `reppendientessepares`.`factura`,`reppendientessepares`.`tipo`,`reppendientessepares`.`estado`,`reppendientessepares`.`recibo`,`reppendientessepares`.`plazo`,`reppendientessepares`.`vencimiento`,`reppendientessepares`.`cliente`,`reppendientessepares`.`nombre`,`reppendientessepares`.`fechaFactura`,`reppendientessepares`.`anulada`,if(isnull(`repcarterasepares`.`valor`),`reppendientessepares`.`valor`,(`reppendientessepares`.`valor` - `repcarterasepares`.`valor`)),`reppendientessepares`.`vendedor`,`reppendientessepares`.`terminal`,`reppendientessepares`.`valor`,`reppendientessepares`.`telefono`,`reppendientessepares`.`placa`,`reppendientessepares`.`direccion`,`reppendientessepares`.`ciudad`,`reppendientessepares`.`idSistema` having (`reppendientessepares`.`tipo` = 'SEPARE') */;

CREATE TABLE `bdcongeladaauditoria` ( `IdBdCongeladaAuditoria` INT(11) NOT NULL AUTO_INCREMENT, `Id` INT(11) DEFAULT NULL, `idFactura` VARCHAR(255) DEFAULT NULL, `cliente` VARCHAR(30) DEFAULT NULL, `vendedor` VARCHAR(30) DEFAULT NULL, `red` VARCHAR(255) DEFAULT NULL, `fechaFactura` DATETIME DEFAULT NULL, `fechaVencimiento` DATETIME DEFAULT NULL, `efectivoGeneral` DECIMAL(18,3) DEFAULT 0.000, `ncGeneral` DECIMAL(18,3) DEFAULT 0.000, `chequeGeneral` DECIMAL(18,3) DEFAULT 0.000, `targetaGeneral` DECIMAL(18,3) DEFAULT 0.000, `totalGeneral` DECIMAL(18,3) DEFAULT 0.000, `descuentoGeneral` DECIMAL(18,3) DEFAULT 0.000, `ivaGeneral` DECIMAL(18,3) DEFAULT 0.000, `subtotalGeneral` DECIMAL(18,3) DEFAULT 0.000, `comprobante` VARCHAR(255) DEFAULT NULL, `cotizacion` VARCHAR(255) DEFAULT NULL, `anulada` TINYINT(1) DEFAULT 0, `anula` VARCHAR(255) DEFAULT NULL, `credito` TINYINT(1) DEFAULT 0, `cxc` VARCHAR(255) DEFAULT NULL, `usuario` VARCHAR(255) DEFAULT NULL, `rtIva` DECIMAL(18,0) DEFAULT 0, `rtIca` DECIMAL(18,0) DEFAULT 0, `rtFuente` DECIMAL(18,0) DEFAULT 0, `otros` DECIMAL(18,0) DEFAULT 0, `observacion` LONGTEXT DEFAULT NULL, `anulada1` TINYINT(1) DEFAULT 0, `anula1` VARCHAR(255) DEFAULT NULL, `credito1` TINYINT(1) DEFAULT 0, `cxc1` VARCHAR(255) DEFAULT NULL, `usuario1` VARCHAR(255) DEFAULT NULL, `fechaAlerta` DATETIME DEFAULT NULL, `terminal` VARCHAR(255) DEFAULT NULL, `estadoGeneral` VARCHAR(255) DEFAULT 'PENDIENTE', `estado2` VARCHAR(255) DEFAULT NULL, `devuelta` DECIMAL(18,3) DEFAULT 0.000, `factura` VARCHAR(255) DEFAULT NULL, `resolucion` VARCHAR(255) DEFAULT NULL, `fechaAnulacion` DATETIME DEFAULT NULL, `cuadreAnulacion` VARCHAR(255) DEFAULT NULL, `usuarioAnula` VARCHAR(255) DEFAULT NULL, `copago` INT(11) DEFAULT 0, `placa` VARCHAR(255) DEFAULT NULL, `garantia` VARCHAR(255) DEFAULT NULL, `diasGarantia` VARCHAR(255) DEFAULT NULL, `rango` VARCHAR(255) DEFAULT NULL, `terminos` LONGTEXT DEFAULT NULL, `notaAnulacion` LONGTEXT DEFAULT NULL, `conseMesa` VARCHAR(255) DEFAULT NULL, `producto` VARCHAR(255) DEFAULT NULL, `lista` DECIMAL(18,3) DEFAULT 0.000, `cantidad` DOUBLE DEFAULT 0, `descuento` DECIMAL(18,3) DEFAULT 0.000, `total` DECIMAL(18,3) DEFAULT 0.000, `iva` DECIMAL(18,3) DEFAULT 0.000, `subtotal` DECIMAL(18,3) DEFAULT 0.000, `NC` VARCHAR(255) DEFAULT NULL, `utilidad` DECIMAL(18,3) DEFAULT 0.000, `concepto` LONGTEXT DEFAULT NULL, `porcDescuento` DOUBLE DEFAULT 0, `descripcion` VARCHAR(255) DEFAULT NULL, `plu` VARCHAR(255) DEFAULT NULL, `cant2` DOUBLE DEFAULT 0, `estado` VARCHAR(255) DEFAULT NULL, `porcIva` INT(11) DEFAULT NULL, `tercero` VARCHAR(255) DEFAULT NULL, `utilidad1` INT(11) DEFAULT NULL, `preparacion` VARCHAR(255) DEFAULT NULL, `turno` VARCHAR(255) DEFAULT NULL, `imei` VARCHAR(255) DEFAULT NULL, `idProd` VARCHAR(255) DEFAULT NULL, `impoconsumoGeneral` DECIMAL(18,3) DEFAULT 0.000, `porcImpo` DOUBLE DEFAULT NULL, `impoconsumo` DECIMAL(18,3) DEFAULT 0.000, `bodega` VARCHAR(40) DEFAULT NULL, `cantidadSolicitada` VARCHAR(50) DEFAULT '0', `fechaRegistro` TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP(), `tipoInstruccion` CHAR(1) DEFAULT NULL COMMENT '0- delete 1- insert 2- update', `datoAnterior` TEXT DEFAULT NULL, PRIMARY KEY (`IdBdCongeladaAuditoria`) ); 

CREATE TRIGGER IF NOT EXISTS deletecongelada AFTER DELETE ON bdcongelada FOR EACH ROW INSERT INTO bdcongeladaauditoria  (Id,  idFactura,  cliente,  vendedor, red,  fechaFactura,  fechaVencimiento,   efectivoGeneral,  ncGeneral,  chequeGeneral,  targetaGeneral,  totalGeneral,  descuentoGeneral,  ivaGeneral,  subtotalGeneral,  comprobante,  cotizacion,  anulada,  anula,  credito,  cxc,  usuario,  rtIva,  rtIca,  rtFuente,   otros,  observacion,  anulada1,  anula1,  credito1,  cxc1,  usuario1,  fechaAlerta,  terminal,  estadoGeneral,  estado2, devuelta,  factura,  resolucion,  fechaAnulacion,  cuadreAnulacion,  usuarioAnula,  copago,  placa,  garantia,  diasGarantia,   rango,  terminos,  notaAnulacion,  conseMesa,  producto,  lista,  cantidad,  descuento,  total,  iva,  subtotal,  NC,  utilidad, concepto,  porcDescuento,  descripcion,  plu,  cant2,  estado,  porcIva,  tercero,  utilidad1,  preparacion,  turno,  imei,   idProd,  impoconsumoGeneral,  porcImpo,  impoconsumo,  bodega,  cantidadSolicitada,  fechaRegistro,  tipoInstruccion,   datoAnterior ) VALUES (OLD.Id,  OLD.idFactura,  OLD.cliente,  OLD.vendedor,  OLD.red,  OLD.fechaFactura,  OLD.fechaVencimiento,  OLD.efectivoGeneral,  OLD.ncGeneral,  OLD.chequeGeneral,  OLD.targetaGeneral,  OLD.totalGeneral,  OLD.descuentoGeneral,  OLD.ivaGeneral,  OLD.subtotalGeneral,  OLD.comprobante,  OLD.cotizacion,  OLD.anulada,  OLD.anula,  OLD.credito,  OLD.cxc,  OLD.usuario,  OLD.rtIva,  OLD.rtIca,  OLD.rtFuente,  OLD.otros,  OLD.observacion,  OLD.anulada1,  OLD.anula1,  OLD.credito1,  OLD.cxc1,  OLD.usuario1,  OLD.fechaAlerta,  OLD.terminal,  OLD.estadoGeneral,  OLD.estado2,  OLD.devuelta,  OLD.factura,  OLD.resolucion,  OLD.fechaAnulacion,  OLD.cuadreAnulacion,  OLD.usuarioAnula,  OLD.copago,  OLD.placa,  OLD.garantia,  OLD.diasGarantia,  OLD.rango,  OLD.terminos,  OLD.notaAnulacion,  OLD.conseMesa,  OLD.producto,  OLD.lista,  OLD.cantidad,  OLD.descuento,  OLD.total,  OLD.iva,  OLD.subtotal,  OLD.NC,  OLD.utilidad,  OLD.concepto,  OLD.porcDescuento,  OLD.descripcion,  OLD.plu,  OLD.cant2,  OLD.estado,  OLD.porcIva,  OLD.tercero,  OLD.utilidad1,  OLD.preparacion,  OLD.turno,  OLD.imei,  OLD.idProd,  OLD.impoconsumoGeneral,  OLD.porcImpo,  OLD.impoconsumo,  OLD.bodega,  OLD.cantidadSolicitada,  NOW(), '0', 'ELIMINADA');
CREATE TRIGGER IF NOT EXISTS insertcongelada AFTER INSERT ON bdcongelada FOR EACH ROW INSERT INTO bdcongeladaauditoria  (Id,  idFactura,  cliente,  vendedor, red,  fechaFactura,  fechaVencimiento,   efectivoGeneral,  ncGeneral,  chequeGeneral,  targetaGeneral,  totalGeneral,  descuentoGeneral,  ivaGeneral,  subtotalGeneral,  comprobante,  cotizacion,  anulada,  anula,  credito,  cxc,  usuario,  rtIva,  rtIca,  rtFuente,   otros,  observacion,  anulada1,  anula1,  credito1,  cxc1,  usuario1,  fechaAlerta,  terminal,  estadoGeneral,  estado2, devuelta,  factura,  resolucion,  fechaAnulacion,  cuadreAnulacion,  usuarioAnula,  copago,  placa,  garantia,  diasGarantia,   rango,  terminos,  notaAnulacion,  conseMesa,  producto,  lista,  cantidad,  descuento,  total,  iva,  subtotal,  NC,  utilidad, concepto,  porcDescuento,  descripcion,  plu,  cant2,  estado,  porcIva,  tercero,  utilidad1,  preparacion,  turno,  imei,   idProd,  impoconsumoGeneral,  porcImpo,  impoconsumo,  bodega,  cantidadSolicitada,  fechaRegistro,  tipoInstruccion,   datoAnterior ) VALUES (NEW.Id,  NEW.idFactura,  NEW.cliente,  NEW.vendedor,  NEW.red,  NEW.fechaFactura,  NEW.fechaVencimiento,  NEW.efectivoGeneral,  NEW.ncGeneral,  NEW.chequeGeneral,  NEW.targetaGeneral,  NEW.totalGeneral,  NEW.descuentoGeneral,  NEW.ivaGeneral,  NEW.subtotalGeneral,  NEW.comprobante,  NEW.cotizacion,  NEW.anulada,  NEW.anula,  NEW.credito,  NEW.cxc,  NEW.usuario,  NEW.rtIva,  NEW.rtIca,  NEW.rtFuente,  NEW.otros,  NEW.observacion,  NEW.anulada1,  NEW.anula1,  NEW.credito1,  NEW.cxc1,  NEW.usuario1,  NEW.fechaAlerta,  NEW.terminal,  NEW.estadoGeneral,  NEW.estado2,  NEW.devuelta,  NEW.factura,  NEW.resolucion,  NEW.fechaAnulacion,  NEW.cuadreAnulacion,  NEW.usuarioAnula,  NEW.copago,  NEW.placa,  NEW.garantia,  NEW.diasGarantia,  NEW.rango,  NEW.terminos,  NEW.notaAnulacion,  NEW.conseMesa,  NEW.producto,  NEW.lista,  NEW.cantidad,  NEW.descuento,  NEW.total,  NEW.iva,  NEW.subtotal,  NEW.NC,  NEW.utilidad,  NEW.concepto,  NEW.porcDescuento,  NEW.descripcion,  NEW.plu,  NEW.cant2,  NEW.estado,  NEW.porcIva,  NEW.tercero,  NEW.utilidad1,  NEW.preparacion,  NEW.turno,  NEW.imei,  NEW.idProd,  NEW.impoconsumoGeneral,  NEW.porcImpo,  NEW.impoconsumo,  NEW.bodega,  NEW.cantidadSolicitada,  NOW(), '1', '');
CREATE TRIGGER IF NOT EXISTS updatecongelada AFTER UPDATE ON bdcongelada FOR EACH ROW INSERT INTO bdcongeladaauditoria  (Id,  idFactura,  cliente,  vendedor, red,  fechaFactura,  fechaVencimiento,   efectivoGeneral,  ncGeneral,  chequeGeneral,  targetaGeneral,  totalGeneral,  descuentoGeneral,  ivaGeneral,  subtotalGeneral,  comprobante,  cotizacion,  anulada,  anula,  credito,  cxc,  usuario,  rtIva,  rtIca,  rtFuente,   otros,  observacion,  anulada1,  anula1,  credito1,  cxc1,  usuario1,  fechaAlerta,  terminal,  estadoGeneral,  estado2, devuelta,  factura,  resolucion,  fechaAnulacion,  cuadreAnulacion,  usuarioAnula,  copago,  placa,  garantia,  diasGarantia,   rango,  terminos,  notaAnulacion,  conseMesa,  producto,  lista,  cantidad,  descuento,  total,  iva,  subtotal,  NC,  utilidad, concepto,  porcDescuento,  descripcion,  plu,  cant2,  estado,  porcIva,  tercero,  utilidad1,  preparacion,  turno,  imei,   idProd,  impoconsumoGeneral,  porcImpo,  impoconsumo,  bodega,  cantidadSolicitada,  fechaRegistro,  tipoInstruccion,   datoAnterior ) VALUES (NEW.Id,  NEW.idFactura,  NEW.cliente,  NEW.vendedor,  NEW.red,  NEW.fechaFactura,  NEW.fechaVencimiento,  NEW.efectivoGeneral,  NEW.ncGeneral,  NEW.chequeGeneral,  NEW.targetaGeneral,  NEW.totalGeneral,  NEW.descuentoGeneral,  NEW.ivaGeneral,  NEW.subtotalGeneral,  NEW.comprobante,  NEW.cotizacion,  NEW.anulada,  NEW.anula,  NEW.credito,  NEW.cxc,  NEW.usuario,  NEW.rtIva,  NEW.rtIca,  NEW.rtFuente,  NEW.otros,  NEW.observacion,  NEW.anulada1,  NEW.anula1,  NEW.credito1,  NEW.cxc1,  NEW.usuario1,  NEW.fechaAlerta,  NEW.terminal,  NEW.estadoGeneral,  NEW.estado2,  NEW.devuelta,  NEW.factura,  NEW.resolucion,  NEW.fechaAnulacion,  NEW.cuadreAnulacion,  NEW.usuarioAnula,  NEW.copago,  NEW.placa,  NEW.garantia,  NEW.diasGarantia,  NEW.rango,  NEW.terminos,  NEW.notaAnulacion,  NEW.conseMesa,  NEW.producto,  NEW.lista,  NEW.cantidad,  NEW.descuento,  NEW.total,  NEW.iva,  NEW.subtotal,  NEW.NC,  NEW.utilidad,  NEW.concepto,  NEW.porcDescuento,  NEW.descripcion,  NEW.plu,  NEW.cant2,  NEW.estado,  NEW.porcIva,  NEW.tercero,  NEW.utilidad1,  NEW.preparacion,  NEW.turno,  NEW.imei,  NEW.idProd,  NEW.impoconsumoGeneral,  NEW.porcImpo,  NEW.impoconsumo,  NEW.bodega,  NEW.cantidadSolicitada,  NOW(), '2', CONCAT ('"', OLD.Id,'","', OLD.idFactura,'","', OLD.cliente,'","', OLD.vendedor,'","', OLD.red,'","', OLD.fechaFactura,'","', OLD.fechaVencimiento,'","', OLD.efectivoGeneral,'","', OLD.ncGeneral,'","', OLD.chequeGeneral,'","', OLD.targetaGeneral,'","', OLD.totalGeneral,'","', OLD.descuentoGeneral,'","', OLD.ivaGeneral,'","', OLD.subtotalGeneral,'","', OLD.comprobante,'","', OLD.cotizacion,'","', OLD.anulada,'","', OLD.anula,'","', OLD.credito,'","', OLD.cxc,'","', OLD.usuario,'","', OLD.rtIva,'","', OLD.rtIca,'","', OLD.rtFuente,'","', OLD.otros,'","', OLD.observacion,'","', OLD.anulada1,'","', OLD.anula1,'","', OLD.credito1,'","', OLD.cxc1,'","', OLD.usuario1,'","', OLD.fechaAlerta,'","', OLD.terminal,'","', OLD.estadoGeneral,'","', OLD.estado2,'","', OLD.devuelta,'","', OLD.factura,'","', OLD.resolucion,'","', OLD.fechaAnulacion,'","', OLD.cuadreAnulacion,'","', OLD.usuarioAnula,'","', OLD.copago,'","', OLD.placa,'","', OLD.garantia,'","', OLD.diasGarantia,'","', OLD.rango,'","', OLD.terminos,'","', OLD.notaAnulacion,'","', OLD.conseMesa,'","', OLD.producto,'","', OLD.lista,'","', OLD.cantidad,'","', OLD.descuento,'","', OLD.total,'","', OLD.iva,'","', OLD.subtotal,'","', OLD.NC,'","', OLD.utilidad,'","', OLD.concepto,'","', OLD.porcDescuento,'","', OLD.descripcion,'","', OLD.plu,'","', OLD.cant2,'","', OLD.estado,'","', OLD.porcIva,'","', OLD.tercero,'","', OLD.utilidad1,'","', OLD.preparacion,'","', OLD.turno,'","', OLD.imei,'","', OLD.idProd,'","', OLD.impoconsumoGeneral,'","', OLD.porcImpo,'","', OLD.impoconsumo,'","', OLD.bodega,'","', OLD.cantidadSolicitada,'"'));
/*!50001  ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `comanda` AS  SELECT `bdproductos`.`grupo` AS `Grupo`, `com`.`Id`            AS `Id`, `com`.`lugar`         AS `lugar`, `com`.`congelada`     AS `congelada`, `com`.`factura`       AS `factura`, `com`.`pedido`        AS `pedido`, `com`.`turno`         AS `turno`, `com`.`consecutivo`   AS `consecutivo`, `com`.`cod`           AS `cod`, `com`.`producto`      AS `producto`, `com`.`opciones`      AS `opciones`, `com`.`ingredientes`  AS `ingredientes`, `com`.`adiciones`     AS `adiciones`, `com`.`aderezos`      AS `aderezos`, `com`.`cant`          AS `cant`, `com`.`observaciones` AS `observaciones` FROM (`bdcomanda` `com` JOIN `bdproductos` ON (`com`.`cod` = `bdproductos`.`idSistema`)) */;
/*!50001  ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `productossinpreparacion` AS  SELECT `bdproductos`.`grupo` AS `Grupo`, `bdcomanda`.`Id`                 AS `Id`, `bdcomanda`.`congelada`          AS `congelada`, `bdcomanda`.`factura`            AS `factura`, `bdcomanda`.`pedido`             AS `pedido`, `bdcomanda`.`cod`                AS `cod`, `bdcomanda`.`producto`           AS `producto`, `bdcomanda`.`opciones`           AS `opciones`, `bdcomanda`.`ingredientes`       AS `ingredientes`, `bdcomanda`.`aderezos`           AS `aderezos`, `bdcomanda`.`cant`               AS `cant`, `bdcomanda`.`observaciones`      AS `observaciones`, `bdcomanda`.`consecutivo`        AS `consecutivo`, `bdcomanda`.`cantidadSolicitada` AS `cantidadSolicitada` FROM `bdcomanda` JOIN `bdproductos` ON (`bdcomanda`.`cod` = `bdproductos`.`idSistema`) WHERE `bdcomanda`.`opciones` = '' AND `bdcomanda`.`ingredientes` = '' AND `bdcomanda`.`aderezos` = '' AND `bdcomanda`.`observaciones` = '' */;
/*!50001  ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `pedidos` AS  SELECT `bdpedido`.`idFactura`        AS `idFactura`, CAST(SUBSTR(`bdpedido`.`idFactura`,8,100) AS SIGNED) AS `ordenId`, `bdpedido`.`cliente`          AS `cliente`, `bdpedido`.`vendedor`         AS `vendedor`, `bdpedido`.`red`              AS `red`, `bdpedido`.`fechaFactura`     AS `fechaFactura`, `bdpedido`.`fechaVencimiento` AS `fechaVencimiento`, `bdpedido`.`efectivoGeneral`  AS `efectivoGeneral`, `bdpedido`.`ncGeneral`        AS `ncGeneral`, `bdpedido`.`chequeGeneral`    AS `chequeGeneral`, `bdpedido`.`targetaGeneral`   AS `targetaGeneral`, `bdpedido`.`totalGeneral`     AS `totalGeneral`, `bdpedido`.`descuentoGeneral` AS `descuentoGeneral`, `bdpedido`.`ivaGeneral`       AS `ivaGeneral`, `bdpedido`.`subtotalGeneral`  AS `subtotalGeneral`, `bdpedido`.`comprobante`      AS `comprobante`, `bdpedido`.`cotizacion`       AS `cotizacion`, `bdpedido`.`anulada`          AS `anulada`, `bdpedido`.`anula`            AS `anula`, `bdpedido`.`credito`          AS `credito`, `bdpedido`.`cxc`              AS `cxc`, `bdpedido`.`usuario`          AS `usuario`, `bdpedido`.`rtIva`            AS `rtIva`, `bdpedido`.`rtIca`            AS `rtIca`, `bdpedido`.`rtFuente`         AS `rtFuente`, `bdpedido`.`otros`            AS `otros`, `bdpedido`.`observacion`      AS `observacion`, `bdpedido`.`anulada1`         AS `anulada1`, `bdpedido`.`anula1`           AS `anula1`, `bdpedido`.`credito1`         AS `credito1`, `bdpedido`.`cxc1`             AS `cxc1`, `bdpedido`.`usuario1`         AS `usuario1`, `bdpedido`.`fechaAlerta`      AS `fechaAlerta`, `bdpedido`.`terminal`         AS `terminal`, `bdpedido`.`estadoGeneral`    AS `estadoGeneral`, `bdpedido`.`estado2`          AS `estado2`, `bdpedido`.`devuelta`         AS `devuelta`, `bdpedido`.`factura`          AS `factura`, `bdpedido`.`resolucion`       AS `resolucion`, `bdpedido`.`fechaAnulacion`   AS `fechaAnulacion`, `bdpedido`.`cuadreAnulacion`  AS `cuadreAnulacion`, `bdpedido`.`usuarioAnula`     AS `usuarioAnula`, `bdpedido`.`copago`           AS `copago`, `bdpedido`.`placa`            AS `placa`, `bdpedido`.`garantia`         AS `garantia`, `bdpedido`.`diasGarantia`     AS `diasGarantia`, `bdpedido`.`rango`            AS `rango`, `bdpedido`.`terminos`         AS `terminos`, `bdpedido`.`notaAnulacion`    AS `notaAnulacion`, `bdpedido`.`conseMesa`        AS `conseMesa`, `bdpedido`.`producto`         AS `producto`, `bdpedido`.`lista`            AS `lista`, `bdpedido`.`cantidad`         AS `cantidad`, `bdpedido`.`descuento`        AS `descuento`, `bdpedido`.`total`            AS `total`, `bdpedido`.`idProd`           AS `idProd`, `bdpedido`.`iva`              AS `iva`, `bdpedido`.`subtotal`         AS `subtotal`, `bdpedido`.`NC`               AS `NC`, `bdpedido`.`utilidad`         AS `utilidad`, `bdpedido`.`concepto`         AS `concepto`, `bdpedido`.`porcDescuento`    AS `porcDescuento`, `bdpedido`.`descripcion`      AS `descripcion`, `bdpedido`.`plu`              AS `plu`, `bdpedido`.`cant2`            AS `cant2`, `bdpedido`.`estado`           AS `estado`, `bdpedido`.`porcIva`          AS `porcIva`, `bdpedido`.`tercero`          AS `tercero`, `bdpedido`.`utilidad1`        AS `utilidad1`, `bdpedido`.`garantia`         AS `nombre`, `bdpedido`.`bodega`           AS `bodega`, `bdterceros`.`telefono`       AS `telefono`, `bdterceros`.`direccion`      AS `direccion`, `bdterceros`.`id`             AS `IdTercero`, `bdpedido`.`factura`          AS `id2`, `bdproductos`.`ubicacion1`    AS `ubicacion1`, `bdproductos`.`referencia`    AS `referencia`, `bdproductos`.`Codigo`        AS `Codigo`, `bdpedido`.`preparacion`      AS `preparacion`, `bdpedido`.`Id`               AS `Idpedido` FROM ((`bdpedido` JOIN `bdproductos` ON (`bdpedido`.`producto` = `bdproductos`.`idSistema`)) LEFT JOIN `bdterceros` ON (`bdpedido`.`cliente` = `bdterceros`.`idSistema`)) ORDER BY CAST(SUBSTR(`bdpedido`.`idFactura`,8,100)AS SIGNED) */;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `totalanulacioncuadre` AS ( SELECT `bdfactura`.`subtotalGeneral` AS `SumaDesubtotal`, `bdfactura`.`totalGeneral` AS `totalAnulacionCuadre`, `bdfactura`.`cuadreAnulacion` AS `cuadreAnulacion`, `bdfactura`.`anulada` AS `contAnuladas` FROM `bdfactura` GROUP BY `bdfactura`.`cuadreAnulacion`) */;

ALTER TABLE bdmaestra ADD COLUMN `tamanoNormal` TINYINT(1) DEFAULT 1;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `liquidarlavadero` AS  select `bdlavado`.`id` AS `id`,`bdlavado`.`fechaRealizado` AS `fechaRealizado`,`bdlavado`.`nombre` AS `nombre`,`bdlavadoproductos`.`servicio` AS `servicio`,`bdlavado`.`placa` AS `placa`,`bdlavado`.`tipoVehiculo` AS `tipoVehiculo`,`bdlavado`.`marca` AS `marca`,`bdlavado`.`liquidado` AS `estadoLavado`,`bdlavadoproductos`.`valor` AS `valor`,`bdlavadoproductos`.`codServicio` AS `codServicio`,`bdlavadoproductos`.`empleado` AS `empleado`,`bdlavadoproductos`.`liquidado` AS `liquidado`,`bdterceros`.`nombre` AS `trabajador`,`bdlavadoproductos`.`valor` - `bdlavadoproductos`.`pago` AS `utilidad`,`bdlavadoproductos`.`pago` AS `pago`,if(`bdfactura`.`credito`,'CREDITO','CONTADO') AS `credito2`,`bdproductos`.`Sub_grupo` AS `Sub_grupo`,`bdlavado`.`cliente` AS `cliente`,1 AS `num` from ((((`bdlavado` join `bdlavadoproductos` on(`bdlavado`.`id` = `bdlavadoproductos`.`IdLavado`)) left join `bdterceros` on(`bdterceros`.`idSistema` = `bdlavadoproductos`.`empleado`)) left join `bdfactura` on(`bdfactura`.`factura` = `bdlavado`.`factura` and `bdfactura`.`cliente` = `bdlavado`.`cliente` and `bdlavado`.`factura` = `bdfactura`.`factura` and `bdfactura`.`producto` = `bdlavadoproductos`.`codServicio`)) join `bdproductos` on(`bdlavadoproductos`.`codServicio` = `bdproductos`.`idSistema`)) */;


insert into `codsEgresos` (`codigo`, `codigoUsuario`, `concepto`, `activo`) values('3','3','LIQUIDACION PERSONAL DE LAVADO','0');

ALTER TABLE bdFactura MODIFY preparacion BLOB;
ALTER TABLE bdcongelada MODIFY preparacion BLOB;	
ALTER TABLE bdPedido MODIFY preparacion BLOB;

ALTER TABLE bdcongeladaauditoria MODIFY datoAnterior BLOB;
ALTER TABLE bdcongeladaauditoria MODIFY preparacion BLOB;
CREATE TABLE `bdpreparacion` ( `id` INT(11) NOT NULL AUTO_INCREMENT, `congelada` VARCHAR(255) NOT NULL, `idCongelada` VARCHAR(11) DEFAULT NULL, `tipo` VARCHAR(255) NOT NULL, `codigo` VARCHAR(255) DEFAULT NULL, `descripcion` VARCHAR(255) DEFAULT NULL, `cantidad` VARCHAR(255) DEFAULT NULL, `estado` VARCHAR(255) DEFAULT NULL, `posicion` VARCHAR(255) DEFAULT NULL, `principal` VARCHAR(255) DEFAULT NULL COMMENT 'codigo principal producto', PRIMARY KEY (`id`) );
ALTER TABLE bdpreparacion ADD COLUMN idCongeladaAdicion VARCHAR(255);
ALTER TABLE configuracion ADD COLUMN `actualizacionObligatoria` VARCHAR(10) DEFAULT 0;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `productossinpreparacion` AS SELECT `bdproductos`.`grupo`            AS `Grupo`, `bdcomanda`.`Id`                 AS `Id`, `bdcomanda`.`congelada`          AS `congelada`, `bdcomanda`.`factura`            AS `factura`, `bdcomanda`.`pedido`             AS `pedido`, `bdcomanda`.`cod`                AS `cod`, `bdcomanda`.`producto`           AS `producto`, `bdcomanda`.`opciones`           AS `opciones`, `bdcomanda`.`ingredientes`       AS `ingredientes`, `bdcomanda`.`aderezos`           AS `aderezos`, `bdcomanda`.`cant`               AS `cant`, `bdcomanda`.`observaciones`      AS `observaciones`, `bdcomanda`.`consecutivo`        AS `consecutivo`, `bdcomanda`.`cantidadSolicitada` AS `cantidadSolicitada` FROM (`bdcomanda` JOIN `bdproductos` ON (`bdcomanda`.`cod` = `bdproductos`.`idSistema`)) WHERE `bdcomanda`.`opciones` = '' AND `bdcomanda`.`ingredientes` = '' AND `bdcomanda`.`aderezos` = '' AND `bdcomanda`.`observaciones` = '' AND (`bdcomanda`.`adiciones` = '')*/;


-- NO /*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `productospreparacion` AS  SELECT `bdproductos`.`grupo`       AS `Grupo`, `bdcomanda`.`Id`            AS `Id`, `bdcomanda`.`congelada`     AS `congelada`, `bdcomanda`.`factura`       AS `factura`, `bdcomanda`.`pedido`        AS `pedido`, `bdcomanda`.`cod`           AS `cod`, `bdcomanda`.`producto`      AS `producto`, `bdcomanda`.`opciones`      AS `opciones`, `bdcomanda`.`ingredientes`  AS `ingredientes`, `bdcomanda`.`aderezos`      AS `aderezos`, `bdcomanda`.`cant`          AS `cant`, `bdcomanda`.`observaciones` AS `observaciones`, `bdcomanda`.`consecutivo`   AS `consecutivo`, `bdcomanda`.`adiciones`     AS `adiciones` FROM (`bdcomanda` JOIN `bdproductos` ON (`bdcomanda`.`cod` = `bdproductos`.`idSistema`)) WHERE (`bdcomanda`.`adiciones` <> '' OR `bdcomanda`.`observaciones` <> '' OR `bdcomanda`.`opciones` <> '' OR `bdcomanda`.`ingredientes` <> '' OR `bdcomanda`.`aderezos` <> '') AND (`bdproductos`.`grupo` NOT IN('GRP-02','GRP-03','GRP-04','GRP-05') OR `bdproductos`.`grupo` IS NULL)*/;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `productospreparacion` AS  SELECT `bdproductos`.`grupo`       AS `Grupo`, `bdcomanda`.`Id`            AS `Id`, `bdcomanda`.`congelada`     AS `congelada`, `bdcomanda`.`factura`       AS `factura`, `bdcomanda`.`pedido`        AS `pedido`, `bdcomanda`.`cod`           AS `cod`, `bdcomanda`.`producto`      AS `producto`, `bdcomanda`.`opciones`      AS `opciones`, `bdcomanda`.`ingredientes`  AS `ingredientes`, `bdcomanda`.`aderezos`      AS `aderezos`, `bdcomanda`.`cant`          AS `cant`, `bdcomanda`.`observaciones` AS `observaciones`, `bdcomanda`.`consecutivo`   AS `consecutivo`, `bdcomanda`.`adiciones`     AS `adiciones` FROM (`bdcomanda` JOIN `bdproductos` ON (`bdcomanda`.`cod` = `bdproductos`.`idSistema`)) WHERE `bdcomanda`.`adiciones` <> '' OR `bdcomanda`.`observaciones` <> '' OR `bdcomanda`.`opciones` <> '' OR `bdcomanda`.`ingredientes` <> '' OR `bdcomanda`.`aderezos` <> '' */;

ALTER TABLE bdterceros ADD COLUMN codigoMoneda VARCHAR(10);
ALTER TABLE bdmonedas ADD COLUMN `codigo` VARCHAR(10);
ALTER TABLE bdmonedas ADD COLUMN `moneda` VARCHAR(100);
UPDATE bdmonedas SET codigo='COP' , moneda='PESOS' WHERE simbolo='$';
ALTER TABLE bdmonedas DROP PRIMARY KEY;
ALTER TABLE bdmonedas ADD PRIMARY KEY (codigo);
INSERT INTO bdmonedas (simbolo,descripcion,codigo,moneda,decimales,estado) VALUES ('$','DOLARES','USD','DÃ“LARES','3',TRUE);
ALTER TABLE bdFactura ADD COLUMN `trm` VARCHAR(10);
ALTER TABLE bdFactura ADD COLUMN `fechatrm` VARCHAR(20);

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `productossinpreparacion` AS SELECT `bdproductos`.`grupo`            AS `Grupo`, `bdcomanda`.`Id`                 AS `Id`, `bdcomanda`.`congelada`          AS `congelada`, `bdcomanda`.`factura`            AS `factura`, `bdcomanda`.`pedido`             AS `pedido`, `bdcomanda`.`cod`                AS `cod`, `bdcomanda`.`producto`           AS `producto`, `bdcomanda`.`opciones`           AS `opciones`, `bdcomanda`.`ingredientes`       AS `ingredientes`, `bdcomanda`.`aderezos`           AS `aderezos`, `bdcomanda`.`cant`               AS `cant`, `bdcomanda`.`observaciones`      AS `observaciones`, `bdcomanda`.`consecutivo`        AS `consecutivo`, `bdcomanda`.`cantidadSolicitada` AS `cantidadSolicitada`, `bdcomanda`.`idCongelada` AS `idCongelada` FROM (`bdcomanda` JOIN `bdproductos` ON (`bdcomanda`.`cod` = `bdproductos`.`idSistema`)) WHERE `bdcomanda`.`opciones` = '' AND `bdcomanda`.`ingredientes` = '' AND `bdcomanda`.`aderezos` = '' AND `bdcomanda`.`observaciones` = '' AND `bdcomanda`.`adiciones` = '' */;
/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `cotizacion` AS  SELECT `bdcotizacion`.`idFactura`        AS `idFactura`, CAST(SUBSTR(`bdcotizacion`.`idFactura`,6,100) AS SIGNED) AS `ordenId`, `bdcotizacion`.`cliente`          AS `cliente`, `bdcotizacion`.`vendedor`         AS `vendedor`, `bdcotizacion`.`bodega`           AS `bodega`, `bdcotizacion`.`red`              AS `red`, `bdcotizacion`.`fechaFactura`     AS `fechaFactura`, `bdcotizacion`.`fechaVencimiento` AS `fechaVencimiento`, `bdcotizacion`.`efectivoGeneral`  AS `efectivoGeneral`, `bdcotizacion`.`ncGeneral`        AS `ncGeneral`, `bdcotizacion`.`chequeGeneral`    AS `chequeGeneral`, `bdcotizacion`.`targetaGeneral`   AS `targetaGeneral`, `bdcotizacion`.`totalGeneral`     AS `totalGeneral`, `bdcotizacion`.`descuentoGeneral` AS `descuentoGeneral`, `bdcotizacion`.`ivaGeneral`       AS `ivaGeneral`, `bdcotizacion`.`subtotalGeneral`  AS `subtotalGeneral`, `bdcotizacion`.`comprobante`      AS `comprobante`, `bdcotizacion`.`cotizacion`       AS `cotizacion`, `bdcotizacion`.`anulada`          AS `anulada`, `bdcotizacion`.`anula`            AS `anula`, `bdcotizacion`.`credito`          AS `credito`, `bdcotizacion`.`cxc`              AS `cxc`, `bdcotizacion`.`usuario`          AS `usuario`, `bdcotizacion`.`rtIva`            AS `rtIva`, `bdcotizacion`.`rtIca`            AS `rtIca`, `bdcotizacion`.`rtFuente`         AS `rtFuente`, `bdcotizacion`.`otros`            AS `otros`, `bdcotizacion`.`observacion`      AS `observacion`, `bdcotizacion`.`anulada1`         AS `anulada1`, `bdcotizacion`.`anula1`           AS `anula1`, `bdcotizacion`.`credito1`         AS `credito1`, `bdcotizacion`.`cxc1`             AS `cxc1`, `bdcotizacion`.`usuario1`         AS `usuario1`, `bdcotizacion`.`fechaAlerta`      AS `fechaAlerta`, `bdcotizacion`.`terminal`         AS `terminal`, `bdcotizacion`.`estadoGeneral`    AS `estadoGeneral`, `bdcotizacion`.`estado2`          AS `estado2`, `bdcotizacion`.`devuelta`         AS `devuelta`, `bdcotizacion`.`factura`          AS `factura`, `bdcotizacion`.`resolucion`       AS `resolucion`, `bdcotizacion`.`fechaAnulacion`   AS `fechaAnulacion`, `bdcotizacion`.`cuadreAnulacion`  AS `cuadreAnulacion`, `bdcotizacion`.`usuarioAnula`     AS `usuarioAnula`, `bdcotizacion`.`copago`           AS `copago`, `bdcotizacion`.`placa`            AS `placa`, `bdcotizacion`.`garantia`         AS `garantia`, `bdcotizacion`.`diasGarantia`     AS `diasGarantia`, `bdcotizacion`.`rango`            AS `rango`, `bdcotizacion`.`terminos`         AS `terminos`, `bdcotizacion`.`notaAnulacion`    AS `notaAnulacion`, `bdcotizacion`.`conseMesa`        AS `conseMesa`, `bdcotizacion`.`producto`         AS `producto`, `bdcotizacion`.`lista`            AS `lista`, `bdcotizacion`.`cantidad`         AS `cantidad`, `bdcotizacion`.`descuento`        AS `descuento`, `bdcotizacion`.`total`            AS `total`, `bdcotizacion`.`iva`              AS `iva`, `bdcotizacion`.`subtotal`         AS `subtotal`, `bdcotizacion`.`NC`               AS `NC`, `bdcotizacion`.`utilidad`         AS `utilidad`, `bdcotizacion`.`concepto`         AS `concepto`, `bdcotizacion`.`porcDescuento`    AS `porcDescuento`, `bdcotizacion`.`descripcion`      AS `descripcion`, `bdcotizacion`.`plu`              AS `plu`, `bdcotizacion`.`cant2`            AS `cant2`, `bdcotizacion`.`estado`           AS `estado`, `bdcotizacion`.`porcIva`          AS `porcIva`, `bdcotizacion`.`tercero`          AS `tercero`, `bdcotizacion`.`utilidad1`        AS `utilidad1`, `bdcotizacion`.`preparacion`      AS `preparacion`, `bdterceros`.`nombre`             AS `nombre`, `bdterceros`.`telefono`           AS `telefono`, `bdterceros`.`celular`            AS `celular`, `bdterceros`.`direccion`          AS `direccion`, `bdterceros`.`id`                 AS `Id` FROM (`bdcotizacion` LEFT JOIN `bdterceros` ON (`bdcotizacion`.`cliente` = `bdterceros`.`idSistema`)) */;

CREATE TABLE `bdprefacturasptm` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `identificacion` varchar(30) NOT NULL COMMENT 'numero de identificacion del adquiriente',
  `digito_verificacion` varchar(3) DEFAULT NULL COMMENT 'digito de verificacion en caso de que el tipo de persona sea juridica',
  `email` varchar(100) DEFAULT NULL COMMENT 'email del cliente',
  `estado` varchar(50) DEFAULT NULL COMMENT 'estado prefactura',
  `fenacimiento` datetime NOT NULL,
  `idTxExterno` bigint(20) DEFAULT NULL,
  `primerApellido` varchar(20) DEFAULT NULL COMMENT 'primer apellido del cliente',
  `primerNombre` varchar(20) DEFAULT NULL COMMENT 'primer nombre del cliente',
  `razonSocial` varchar(50) DEFAULT NULL COMMENT 'razon social del cliente',
  `responsable_iva` varchar(50) DEFAULT NULL COMMENT 'campo que me identifica si el cliente es o no responsable de iva',
  `segundoApellido` varchar(20) DEFAULT NULL COMMENT 'segundo apellido del cliente',
  `segundoNombre` varchar(20) DEFAULT NULL COMMENT 'segundo nombre del cliente',
  `telefono` varchar(30) DEFAULT NULL COMMENT 'telefono del cliente',
  `tipoDocumento` varchar(30) NOT NULL COMMENT 'tipo  de identificacion del adquiriente',
  `tipoPersona` varchar(20) DEFAULT NULL COMMENT 'campo que me identifica el tipo de persona del adquiriente',
  `cddane` varchar(100) DEFAULT NULL COMMENT 'codigo dane',
  `direccion` varchar(100) DEFAULT NULL COMMENT 'direccion del cliente',
  `estadoPrefactura` varchar(2) DEFAULT '0' COMMENT 'estado de la prefactura 0-pendiente 1-facturado',
  `factura` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `idTxExterno_unico` (`idTxExterno`)
);

CREATE TABLE `bdprefacturasdetalleptm` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `idApi` bigint(20) DEFAULT NULL COMMENT 'id que viene en el servicio api',
  `CANTIDAD` double NOT NULL COMMENT 'Cantidad del producto',
  `CDPRODUCTO` varchar(30) NOT NULL COMMENT 'codigo del producto',
  `DSPRODUCTO` varchar(255) NOT NULL COMMENT 'Descripcion del producto',
  `DSESTANDAR_PRODUCTO` varchar(255) DEFAULT NULL COMMENT 'Descripcion del estandar del producto',
  `PORCENTAJE` double NOT NULL COMMENT 'Porcentaje del impuesto',
  `VRUNITARIO` double NOT NULL COMMENT 'Valor unitario del producto',
  `DSUNIDAD_MEDIDA` varchar(30) NOT NULL COMMENT 'Descripcion de la unidad de medida del  producto',
  `VRTOTAL_PRODUCTO` double NOT NULL COMMENT 'Valor total del producto',
  `ID_PREFACTURA` bigint(20) DEFAULT NULL,
  `PORCENTAJE_DESCUENTO` double NOT NULL COMMENT 'Porcentaje descuento',
  `TIPO_DESCUENTO` varchar(30) NOT NULL COMMENT 'Tipo descuento',
  `VRDESCUENTO` double NOT NULL COMMENT 'Valor descuento',
  PRIMARY KEY (`id`),
  KEY `foranea_prefactura` (`ID_PREFACTURA`),
  CONSTRAINT `foranea_prefactura` FOREIGN KEY (`ID_PREFACTURA`) REFERENCES `bdprefacturasptm` (`id`)
);

CREATE TABLE `bdlogsfacturaapi` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `estado` varchar(255) DEFAULT NULL,
  `numeroFactura` varchar(255) DEFAULT NULL,
  `idExterno` varchar(255) DEFAULT NULL,
  `mensaje` blob DEFAULT NULL,
  `errorApp` blob DEFAULT NULL,
  `errorRespuesta` blob DEFAULT NULL,
  `fechaRegistro` timestamp NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`id`)
);

/*!50001 ALTER  ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `factura1` AS SELECT `bdfactura`.`idFactura` AS `idFactura`,CAST(SUBSTR(`bdfactura`.`idFactura`,6,100) AS SIGNED) AS `ordenId`,`bdterceros`.`id` AS `cliente`, `bdfactura`.`vendedor` AS `vendedor`,`bdfactura`.`red` AS `red`,`bdfactura`.`fechaFactura` AS `fechaFactura`, `bdfactura`.`fechaVencimiento` AS `fechaVencimiento`,`bdfactura`.`efectivoGeneral` AS `efectivoGeneral`,`bdfactura`.`ncGeneral` AS `ncGeneral`, `bdfactura`.`chequeGeneral` AS `chequeGeneral`,`bdfactura`.`targetaGeneral` AS `targetaGeneral`,`bdfactura`.`totalGeneral` AS `totalGeneral`, `bdfactura`.`descuentoGeneral` AS `descuentoGeneral`,`bdfactura`.`ivaGeneral` AS `ivaGeneral`,`bdfactura`.`subtotalGeneral` AS `subtotalGeneral`, `bdfactura`.`comprobante` AS `comprobante`,`bdfactura`.`cotizacion` AS `cotizacion`,`bdfactura`.`anulada` AS `anulada`,`bdfactura`.`anula` AS `anula`, `bdfactura`.`credito` AS `credito`,`bdfactura`.`cxc` AS `cxc`,`bdfactura`.`usuario` AS `usuario`,`bdfactura`.`rtIva` AS `rtIva`, `bdfactura`.`rtIca` AS `rtIca`,`bdfactura`.`rtFuente` AS `rtFuente`,`bdfactura`.`otros` AS `otros`,`bdfactura`.`observacion` AS `observacion`, `bdfactura`.`anulada1` AS `anulada1`,`bdfactura`.`anula1` AS `anula1`,`bdfactura`.`credito1` AS `credito1`,`bdfactura`.`cxc1` AS `cxc1`, `bdfactura`.`usuario1` AS `usuario1`,`bdfactura`.`fechaAlerta` AS `fechaAlerta`,`bdfactura`.`terminal` AS `terminal`, `bdfactura`.`estadoGeneral` AS `estadoGeneral`,`bdfactura`.`estado2` AS `estado2`,`bdfactura`.`devuelta` AS `devuelta`,`bdfactura`.`factura` AS `factura`, `bdfactura`.`resolucion` AS `resolucion`,`bdfactura`.`fechaAnulacion` AS `fechaAnulacion`,`bdfactura`.`cuadreAnulacion` AS `cuadreAnulacion`, `bdfactura`.`usuarioAnula` AS `usuarioAnula`,`bdfactura`.`copago` AS `copago`,`bdfactura`.`garantia` AS `garantia`, `bdfactura`.`diasGarantia` AS `diasGarantia`,`bdfactura`.`rango` AS `rango`,`bdfactura`.`terminos` AS `terminos`, `bdfactura`.`notaAnulacion` AS `notaAnulacion`,`bdfactura`.`conseMesa` AS `conseMesa`,`bdfactura`.`producto` AS `producto`,`bdfactura`.`lista` AS `lista`, `bdfactura`.`cantidad` AS `cantidad`,`bdfactura`.`descuento` AS `descuento`,`bdfactura`.`total` AS `total`,`bdfactura`.`iva` AS `iva`, `bdfactura`.`subtotal` AS `subtotal`,`bdfactura`.`NC` AS `NC`,`bdfactura`.`utilidad` AS `utilidad`,`bdfactura`.`concepto` AS `concepto`, `bdfactura`.`porcDescuento` AS `porcDescuento`,`bdfactura`.`descripcion` AS `descripcion`,`bdfactura`.`plu` AS `plu`,`bdfactura`.`cant2` AS `cant2`, `bdfactura`.`estado` AS `estado`,`bdfactura`.`porcIva` AS `porcIva`,`bdfactura`.`tercero` AS `tercero`,`bdfactura`.`utilidad1` AS `utilidad1`, `bdterceros`.`nombre` AS `nombre`,`bdterceros`.`telefono` AS `telefono`,`bdterceros`.`direccion` AS `direccion`, IF(`bdprestamo`.`cuotaInicial` IS NULL,0,`bdprestamo`.`cuotaInicial`) AS `cuotaInicial2`,`bdfactura`.`factura` AS `id2`, `bdproductos`.`ubicacion1` AS `ubicacion1`,`bdproductos`.`referencia` AS `referencia`,`bdproductos`.`unidad` AS `unidad`, `bdfactura`.`subtotalGeneral` - `bdfactura`.`descuentoGeneral` AS `valor3`, IF(`bdfactura`.`producto` = 'PROD-000000032',`bdfactura`.`impuesto`,'0') AS `impuesto`,`bdcxc`.`plazo` AS `plazo`, `bdterceros`.`nombreContacto` AS `nombreContacto`,`bdterceros`.`cargo` AS `cargo`,`bdfactura`.`turno` AS `turno`,`bdproductos`.`grupo` AS `Grupo`, `bdterceros`.`eps` AS `eps`,`bdepsprecargados`.`nombre` AS `nombreEps`,`bdfactura`.`Id` AS `Id`,`bdfactura`.`placa` AS `placa`,`bdplacas`.`tipo` AS `tipo`, `bdparqueaderoautos`.`fIngreso` AS `fIngreso`,`bdparqueaderoautos`.`fSalida` AS `fSalida`,`bdparqueaderoautos`.`hIngreso` AS `hIngreso`, `bdparqueaderoautos`.`hSalida` AS `hSalida`,`bdparqueaderoautos`.`horas` AS `horas`,`bdfactura`.`imei` AS `imei`,`bddetalleproductos`.`color` AS `color`, `bdterceros`.`idSistema` AS `idSistema`,`bdfactura`.`impoconsumo` AS `impoconsumo`,`bdproductos`.`Codigo` AS `Codigo`, `bdfactura`.`totalPropina` AS `totalPropina`,`bdfactura`.`hora` AS `hora`,`bdfactura`.`idProd` AS `idProd`,`bdgrupo`.`nombre` AS `nombreGrupo`, `bdfactura`.`impoGeneral` AS `impoGeneral`,`bdfactura`.`porcImpo` AS `porcImpo`,`bdfactura`.`bodega` AS `bodega`,`bdproductos`.`codContable` AS `codEstandar`,`bdproductos`.`manejaInventario` AS `manejaInventario`, `bdfactura`.`trm` AS `trm`,`bdfactura`.`fechatrm` AS `fechatrm`  FROM ((((((((`bdfactura`  LEFT JOIN `bdprestamo` ON(`bdfactura`.`idFactura` = `bdprestamo`.`factura`))  LEFT JOIN `bdcxc` ON(`bdfactura`.`factura` = `bdcxc`.`factura2`))  LEFT JOIN `bdplacas` ON(`bdfactura`.`placa` = `bdplacas`.`placa`))  LEFT JOIN `bdparqueaderoautos` ON(`bdparqueaderoautos`.`factura` = `bdfactura`.`factura`)) LEFT JOIN `bddetalleproductos` ON(`bdfactura`.`idProd` = `bddetalleproductos`.`Id`))  LEFT JOIN `bdproductos` ON(`bdfactura`.`producto` = `bdproductos`.`idSistema`))  LEFT JOIN (`bdterceros`  LEFT JOIN `bdepsprecargados` ON(`bdepsprecargados`.`Id` = `bdterceros`.`eps`)) ON(`bdfactura`.`cliente` = `bdterceros`.`idSistema`)) LEFT JOIN `bdgrupo` ON(`bdproductos`.`grupo` = `bdgrupo`.`codigo`)) GROUP BY `bdfactura`.`idFactura`,CAST(SUBSTR(`bdfactura`.`idFactura`,6,100) AS SIGNED),`bdterceros`.`id`,`bdfactura`.`vendedor`,`bdfactura`.`red`,`bdfactura`.`fechaFactura`,`bdfactura`.`fechaVencimiento`,`bdfactura`.`efectivoGeneral`,`bdfactura`.`ncGeneral`,`bdfactura`.`chequeGeneral`,`bdfactura`.`targetaGeneral`,`bdfactura`.`totalGeneral`,`bdfactura`.`descuentoGeneral`,`bdfactura`.`ivaGeneral`,`bdfactura`.`subtotalGeneral`,`bdfactura`.`comprobante`,`bdfactura`.`cotizacion`,`bdfactura`.`anulada`,`bdfactura`.`anula`,`bdfactura`.`credito`,`bdfactura`.`cxc`,`bdfactura`.`usuario`,`bdfactura`.`rtIva`,`bdfactura`.`rtIca`,`bdfactura`.`rtFuente`,`bdfactura`.`otros`,`bdfactura`.`anulada1`,`bdfactura`.`anula1`,`bdfactura`.`credito1`,`bdfactura`.`cxc1`,`bdfactura`.`usuario1`,`bdfactura`.`fechaAlerta`,`bdfactura`.`terminal`,`bdfactura`.`estadoGeneral`,`bdfactura`.`estado2`,`bdfactura`.`devuelta`,`bdfactura`.`resolucion`,`bdfactura`.`fechaAnulacion`,`bdfactura`.`cuadreAnulacion`,`bdfactura`.`usuarioAnula`,`bdfactura`.`copago`,`bdfactura`.`garantia`,`bdfactura`.`diasGarantia`,`bdfactura`.`rango`,`bdfactura`.`conseMesa`,`bdfactura`.`producto`,`bdfactura`.`lista`,`bdfactura`.`cantidad`,`bdfactura`.`descuento`,`bdfactura`.`total`,`bdfactura`.`iva`,`bdfactura`.`subtotal`,`bdfactura`.`NC`,`bdfactura`.`utilidad`,`bdfactura`.`porcDescuento`,`bdfactura`.`descripcion`,`bdfactura`.`plu`,`bdfactura`.`cant2`,`bdfactura`.`estado`,`bdfactura`.`porcIva`,`bdfactura`.`tercero`,`bdfactura`.`utilidad1`,`bdterceros`.`nombre`,`bdterceros`.`telefono`,`bdterceros`.`direccion`,IF(`bdprestamo`.`cuotaInicial` IS NULL,0,`bdprestamo`.`cuotaInicial`),`bdfactura`.`factura`,`bdproductos`.`ubicacion1`,`bdproductos`.`referencia`,`bdproductos`.`unidad`,`bdfactura`.`subtotalGeneral` - `bdfactura`.`descuentoGeneral`,IF(`bdfactura`.`producto` = 'PROD-000000032',`bdfactura`.`impuesto`,'0'),`bdterceros`.`nombreContacto`,`bdterceros`.`cargo`,`bdfactura`.`turno`,`bdproductos`.`grupo`,`bdterceros`.`eps`,`bdepsprecargados`.`nombre`,`bdfactura`.`Id`,`bdfactura`.`placa`,`bdplacas`.`tipo`,`bdparqueaderoautos`.`fIngreso`,`bdparqueaderoautos`.`fSalida`,`bdparqueaderoautos`.`hIngreso`,`bdparqueaderoautos`.`hSalida`,`bdparqueaderoautos`.`horas`,`bdfactura`.`imei`,`bddetalleproductos`.`color`,`bdterceros`.`idSistema`,`bdfactura`.`impoconsumo`,`bdproductos`.`Codigo`,`bdgrupo`.`nombre`,`bdfactura`.`impoGeneral`, `bdfactura`.`trm`,`bdfactura`.`fechatrm`, `bdfactura`.`porcImpo`,`bdfactura`.`bodega`,`bdproductos`.`codContable` ORDER BY `bdfactura`.`Id` */;
/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`click`@`localhost` SQL SECURITY DEFINER VIEW `factura` AS ( SELECT `factura1`.`idFactura`         AS `idFactura`, `factura1`.`ordenId`           AS `ordenId`, `factura1`.`cliente`           AS `cliente`, `factura1`.`vendedor`          AS `vendedor`, `factura1`.`red`               AS `red`, `factura1`.`fechaFactura`      AS `fechaFactura`, `factura1`.`fechaVencimiento`  AS `fechaVencimiento`, `factura1`.`efectivoGeneral`   AS `efectivoGeneral`, `factura1`.`ncGeneral`         AS `ncGeneral`, `factura1`.`chequeGeneral`     AS `chequeGeneral`, `factura1`.`targetaGeneral`    AS `targetaGeneral`, `factura1`.`totalGeneral`      AS `totalGeneral`, `factura1`.`descuentoGeneral`  AS `descuentoGeneral`, `factura1`.`ivaGeneral`        AS `ivaGeneral`, `factura1`.`subtotalGeneral`   AS `subtotalGeneral`, `factura1`.`comprobante`       AS `comprobante`, `factura1`.`cotizacion`        AS `cotizacion`, `factura1`.`anulada`           AS `anulada`, `factura1`.`anula`             AS `anula`, `factura1`.`credito`           AS `credito`, `factura1`.`cxc`               AS `cxc`, `factura1`.`usuario`           AS `usuario`, `factura1`.`rtIva`             AS `rtIva`, `factura1`.`rtIca`             AS `rtIca`, `factura1`.`rtFuente`          AS `rtFuente`, `factura1`.`otros`             AS `otros`, `factura1`.`observacion`       AS `observacion`, `factura1`.`anulada1`          AS `anulada1`, `factura1`.`anula1`            AS `anula1`, `factura1`.`credito1`          AS `credito1`, `factura1`.`cxc1`              AS `cxc1`, `factura1`.`usuario1`          AS `usuario1`, `factura1`.`fechaAlerta`       AS `fechaAlerta`, `factura1`.`terminal`          AS `terminal`, `factura1`.`estadoGeneral`     AS `estadoGeneral`, `factura1`.`estado2`           AS `estado2`, `factura1`.`devuelta`          AS `devuelta`, `factura1`.`factura`           AS `factura`, `factura1`.`resolucion`        AS `resolucion`, `factura1`.`fechaAnulacion`    AS `fechaAnulacion`, `factura1`.`cuadreAnulacion`   AS `cuadreAnulacion`, `factura1`.`usuarioAnula`      AS `usuarioAnula`, `factura1`.`copago`            AS `copago`, `factura1`.`garantia`          AS `garantia`, `factura1`.`diasGarantia`      AS `diasGarantia`, `factura1`.`rango`             AS `rango`, `factura1`.`terminos`          AS `terminos`, `factura1`.`notaAnulacion`     AS `notaAnulacion`, `factura1`.`conseMesa`         AS `conseMesa`, `factura1`.`producto`          AS `producto`, `factura1`.`lista`             AS `lista`, `factura1`.`cantidad`          AS `cantidad`, `factura1`.`descuento`         AS `descuento`, `factura1`.`total`             AS `total`, `factura1`.`iva`               AS `iva`, `factura1`.`subtotal`          AS `subtotal`, `factura1`.`NC`                AS `NC`, `factura1`.`utilidad`          AS `utilidad`, `factura1`.`concepto`          AS `concepto`, `factura1`.`porcDescuento`     AS `porcDescuento`, `factura1`.`descripcion`       AS `descripcion`, `factura1`.`plu`               AS `plu`, `factura1`.`cant2`             AS `cant2`, `factura1`.`estado`            AS `estado`, `factura1`.`porcIva`           AS `porcIva`, `factura1`.`tercero`           AS `tercero`, `factura1`.`utilidad1`         AS `utilidad1`, `factura1`.`nombre`            AS `nombre`, `factura1`.`telefono`          AS `telefono`, `factura1`.`direccion`         AS `direccion`, `factura1`.`cuotaInicial2`     AS `cuotaInicial2`, `factura1`.`id2`               AS `id2`, `factura1`.`ubicacion1`        AS `ubicacion1`, `factura1`.`referencia`        AS `referencia`, `factura1`.`valor3`            AS `valor3`, `factura1`.`impuesto`          AS `impuesto`, `factura1`.`plazo`             AS `plazo`, `factura1`.`nombreContacto`    AS `nombreContacto`, `factura1`.`cargo`             AS `cargo`, `factura1`.`turno`             AS `turno`, `factura1`.`Grupo`             AS `Grupo`, `factura1`.`eps`               AS `eps`, `factura1`.`nombreEps`         AS `nombreEps`, `factura1`.`Id`                AS `Id`, `factura1`.`placa`             AS `placa`, `factura1`.`tipo`              AS `tipo`, `factura1`.`fIngreso`          AS `fIngreso`, `factura1`.`fSalida`           AS `fSalida`, `factura1`.`hIngreso`          AS `hIngreso`, `factura1`.`hSalida`           AS `hSalida`, `factura1`.`horas`             AS `horas`, `factura1`.`imei`              AS `imei`, `factura1`.`color`             AS `color`, `factura1`.`idSistema`         AS `idSistema`, `factura1`.`impoconsumo`       AS `impoconsumo`, `factura1`.`Codigo`            AS `Codigo`, `factura1`.`totalPropina`      AS `totalPropina`, `factura1`.`hora`              AS `hora`, `factura1`.`idProd`            AS `idProd`, `factura1`.`nombreGrupo`       AS `nombreGrupo`, `factura1`.`impoGeneral`       AS `impoGeneral`, `factura1`.`porcImpo`          AS `porcImpo`, `factura1`.`bodega`            AS `bodega`, `factura1`.`codEstandar`       AS `codEstandar`, `factura1`.`unidad`            AS `unidad`, `factura1`.`manejaInventario`  AS `manejaInventario`, `bdmaestra`.`anexoFacturacion` AS `anexoFacturacion`, IF(`factura1`.`plazo` <> 0,`factura1`.`plazo`,'0') AS `plazo1`, `factura1`.`trm`  AS `trm`, `factura1`.`fechatrm`  AS `fechatrm` FROM (`factura1` JOIN `bdmaestra`) ORDER BY `factura1`.`Id`) */;

ALTER TABLE bdFactura MODIFY otros decimal(18,2);
UPDATE `bdmedida` SET nombre = "SPRAY_PEQUENO" WHERE Id = 1;
DELETE FROM `bdmedida` WHERE Id = 71;

/*!50001 ALTER ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `abononuevo` AS ( SELECT `bdabono`.`id`                  AS `id`, `bdabono`.`fecha`               AS `fecha`, `bdterceros`.`nombre`           AS `nombre`, `bdterceros`.`id`               AS `cliente`, `bdabono`.`numFactura`          AS `numFactura`, `bdabono`.`totalFactura`        AS `totalFactura`, `bdabono`.`comprobante`         AS `comprobante`, `bdabono`.`abonoActual`         AS `abonoActual`, `bdabono`.`abonoLetras`         AS `abonoLetras`, `bdabono`.`abonosAnteriores`    AS `abonosAnteriores`, IF(`bdabonos`.`cheque` IS NULL,0,`bdabonos`.`cheque`) AS `cheque`, IF(`bdabonos`.`targeta` IS NULL,0,`bdabonos`.`targeta`) AS `targeta`, IF(`bdabonos`.`efectivo` IS NULL,0,`bdabonos`.`efectivo`) AS `efectivo`, IF(`bdabonos`.`nc` IS NULL,0,`bdabonos`.`nc`) AS `nc`, IF(`bdabonos`.`rtIva` IS NULL,0,`bdabonos`.`rtIva`) AS `rtIva`, IF(`bdabonos`.`rtIca` IS NULL,0,`bdabonos`.`rtIca`) AS `rtIca`, IF(`bdabonos`.`rtFuente` IS NULL,0,`bdabonos`.`rtFuente`) AS `rtFuente`, IF(`bdabonos`.`otros` IS NULL,0,`bdabonos`.`otros`) AS `otros`, IF(`bdabonos`.`descuentos` IS NULL,0,`bdabonos`.`descuentos`) AS `descuentos`, IF(`bdabonogeneral`.`AbonoGeneral` IS NULL,0,`bdabonogeneral`.`AbonoGeneral`) AS `abonoGeneral`, IF(`bdabonogeneral`.`saldoTotal` IS NULL,0,`bdabonogeneral`.`saldoTotal`) AS `saldoTotalGeneral`, IF(`bdabonogeneral`.`valor` IS NULL,0,`bdabonogeneral`.`valor`) AS `valorGeneral`, `bdabonogeneral`.`enLetra`      AS `enLetra`, IF(`repcart`.`valor` IS NULL,0,`bdabonogeneral`.`saldoTotal` - `repcart`.`valor`) AS `saldoFaltante`, `bdabono`.`abono`               AS `abono`, SUBSTR(`bdabono`.`abono`,7)     AS `abono2` FROM (((((`bdabono` LEFT JOIN `bdabonos` ON (`bdabonos`.`factura` = `bdabono`.`abono`)) LEFT JOIN `bdterceros` ON (`bdabono`.`cliente` = `bdterceros`.`idSistema`)) LEFT JOIN `bdabonogeneral` ON (`bdabono`.`abono` = `bdabonogeneral`.`abono`)) LEFT JOIN `bdcxc` ON (`bdcxc`.`factura2` = `bdabonogeneral`.`AbonoGeneral`)) LEFT JOIN `repcart` ON (`repcart`.`fact` = `bdabonogeneral`.`AbonoGeneral`)) GROUP BY `bdabono`.`fecha`,`bdterceros`.`nombre`,`bdterceros`.`id`,`bdabono`.`numFactura`,`bdabono`.`totalFactura`,`bdabono`.`comprobante`,`bdabono`.`abonoActual`,`bdabono`.`abonoLetras`,`bdabono`.`abonosAnteriores`,`bdabonos`.`cheque`,`bdabonos`.`targeta`,`bdabonos`.`efectivo`,`bdabonos`.`nc`,`bdabonos`.`rtIva`,`bdabonos`.`rtIca`,`bdabonos`.`rtFuente`,`bdabonos`.`otros`,`bdabonos`.`descuentos`,`bdabonogeneral`.`AbonoGeneral`,`bdabonogeneral`.`saldoTotal`,`bdabonogeneral`.`valor`,IF(`repcart`.`valor` IS NULL,0,`bdabonogeneral`.`saldoTotal` - `repcart`.`valor`),`bdabono`.`abono`,SUBSTR(`bdabono`.`abono`,7)) */;